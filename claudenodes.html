<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Opinion Map: Parking Mandates</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            overflow-x: hidden;
        }
        .node {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .node:hover {
            transform: scale(1.1);
            z-index: 100;
        }
        .node.active {
            transform: scale(1.15);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            z-index: 100;
        }
        .connection-line {
            transition: all 0.3s ease;
            opacity: 0.2;
        }
        .connection-line.active {
            opacity: 1;
            stroke-width: 3;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .pathway {
            transition: all 0.3s ease;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        .pathway-active {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="max-w-7xl mx-auto p-6">
        <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 text-black p-8 rounded-lg shadow-lg mb-6">
            <h1 class="text-4xl font-bold mb-2">Interactive Public Opinion Map</h1>
            <p class="text-xl">Parking Mandates: How Opinion Forms</p>
            <p class="text-sm mt-2 opacity-90">Click on nodes to trace opinion pathways | Hover to highlight connections</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-6">
            <div class="lg:col-span-1 bg-white p-6 rounded-lg shadow">
                <h3 class="font-bold text-lg mb-4">Show Pathways:</h3>
                <div class="space-y-2">
                    <button onclick="showPathway('pro')" class="w-full px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600">
                        Pro-Mandate Path
                    </button>
                    <button onclick="showPathway('anti')" class="w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                        Anti-Mandate Path
                    </button>
                    <button onclick="showPathway('business')" class="w-full px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600">
                        Business Owner Path
                    </button>
                    <button onclick="showPathway('uncertain')" class="w-full px-4 py-2 bg-yellow-400 text-white rounded hover:bg-yellow-500">
                        Uncertain/Developer Path
                    </button>
                    <button onclick="clearPathways()" class="w-full px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600">
                        Clear All
                    </button>
                </div>

                <div class="mt-6">
                    <h3 class="font-bold text-lg mb-4">Legend:</h3>
                    <div class="legend-item">
                        <div class="w-6 h-6 bg-blue-500 rounded"></div>
                        <span class="text-sm">Beliefs</span>
                    </div>
                    <div class="legend-item">
                        <div class="w-6 h-6 bg-purple-500 rounded-full"></div>
                        <span class="text-sm">Values</span>
                    </div>
                    <div class="legend-item">
                        <div class="w-6 h-6 bg-gray-400 rounded-full"></div>
                        <span class="text-sm">Sources</span>
                    </div>
                    <div class="legend-item">
                        <div class="w-6 h-6 bg-yellow-400 rounded-lg"></div>
                        <span class="text-sm">Central Issue</span>
                    </div>
                    <div class="legend-item">
                        <div class="w-6 h-6 bg-green-500"></div>
                        <span class="text-sm">Support</span>
                    </div>
                    <div class="legend-item">
                        <div class="w-6 h-6 bg-red-500"></div>
                        <span class="text-sm">Oppose</span>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-3 bg-white p-6 rounded-lg shadow">
                <svg id="opinion-map" width="100%" height="800" viewBox="0 0 1000 800">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#666" />
                        </marker>
                        <marker id="arrowhead-active" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#3B82F6" />
                        </marker>
                    </defs>

                    <g id="connections">
                        <line class="connection-line pathway-pro" x1="180" y1="180" x2="320" y2="330" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-pro" x1="320" y1="330" x2="430" y2="500" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-pro" x1="430" y1="500" x2="800" y2="670" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-anti" x1="820" y1="180" x2="680" y2="330" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-anti" x1="680" y1="330" x2="650" y2="500" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-anti" x1="650" y1="500" x2="200" y2="670" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-business" x1="200" y1="100" x2="370" y2="250" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-business" x1="370" y1="250" x2="520" y2="210" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-business" x1="520" y1="210" x2="800" y2="670" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-uncertain" x1="500" y1="100" x2="680" y2="330" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-uncertain" x1="680" y1="330" x2="520" y2="210" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line pathway-uncertain" x1="520" y1="210" x2="500" y2="660" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/> <line class="connection-line" x1="150" y1="600" x2="430" y2="500" stroke="#666" stroke-width="1" marker-end="url(#arrowhead)"/> <line class="connection-line" x1="850" y1="600" x2="700" y2="450" stroke="#666" stroke-width="1" marker-end="url(#arrowhead)"/> <line class="connection-line" x1="700" y1="450" x2="700" y2="450" stroke="#666" stroke-width="1" marker-end="url(#arrowhead)"/> </g>

                    <g class="node" data-id="center" onclick="toggleNode(this)">
                        <rect x="400" y="360" width="200" height="80" rx="10" fill="#FCD34D" stroke="#F59E0B" stroke-width="3"/>
                        <text x="500" y="390" text-anchor="middle" font-size="14" font-weight="bold" fill="#000">Should cities</text>
                        <text x="500" y="410" text-anchor="middle" font-size="14" font-weight="bold" fill="#000">eliminate parking</text>
                        <text x="500" y="430" text-anchor="middle" font-size="14" font-weight="bold" fill="#000">mandates?</text>
                    </g>

                    <g class="node" data-id="source1" onclick="toggleNode(this)">
                        <ellipse cx="180" cy="180" rx="80" ry="50" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="2"/>
                        <text x="180" y="175" text-anchor="middle" font-size="11" font-weight="bold">Local News</text>
                        <text x="180" y="190" text-anchor="middle" font-size="10">("Parking Crisis")</text>
                    </g>

                    <g class="node" data-id="source2" onclick="toggleNode(this)">
                        <ellipse cx="820" cy="180" rx="80" ry="50" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="2"/>
                        <text x="820" y="175" text-anchor="middle" font-size="11" font-weight="bold">Strong Towns</text>
                        <text x="820" y="190" text-anchor="middle" font-size="10">(Research)</text>
                    </g>

                    <g class="node" data-id="source3" onclick="toggleNode(this)">
                        <ellipse cx="200" cy="100" rx="80" ry="50" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="2"/>
                        <text x="200" y="95" text-anchor="middle" font-size="11" font-weight="bold">Personal</text>
                        <text x="200" y="110" text-anchor="middle" font-size="10">Experience</text>
                    </g>

                    <g class="node" data-id="source4" onclick="toggleNode(this)">
                        <ellipse cx="150" cy="600" rx="80" ry="50" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="2"/>
                        <text x="150" y="595" text-anchor="middle" font-size="11" font-weight="bold">Neighbor</text>
                        <text x="150" y="610" text-anchor="middle" font-size="10">Conversations</text>
                    </g>

                    <g class="node" data-id="source5" onclick="toggleNode(this)">
                        <ellipse cx="850" cy="600" rx="80" ry="50" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="2"/>
                        <text x="850" y="595" text-anchor="middle" font-size="11" font-weight="bold">City Planner</text>
                        <text x="850" y="610" text-anchor="middle" font-size="10">Reports</text>
                    </g>

                    <g class="node" data-id="source6" onclick="toggleNode(this)">
                        <ellipse cx="500" cy="100" rx="80" ry="50" fill="#D1D5DB" stroke="#9CA3AF" stroke-width="2"/>
                        <text x="500" y="95" text-anchor="middle" font-size="11" font-weight="bold">Developer</text>
                        <text x="500" y="110" text-anchor="middle" font-size="10">Talking Points</text>
                    </g>

                    <g class="node" data-id="belief1" onclick="toggleNode(this)">
                        <rect x="250" y="300" width="140" height="60" rx="5" fill="#3B82F6" stroke="#1E40AF" stroke-width="2"/>
                        <text x="320" y="320" text-anchor="middle" font-size="10" fill="white" font-weight="bold">Won't be enough</text>
                        <text x="320" y="335" text-anchor="middle" font-size="10" fill="white" font-weight="bold">parking without</text>
                        <text x="320" y="350" text-anchor="middle" font-size="10" fill="white" font-weight="bold">mandates</text>
                    </g>

                    <g class="node" data-id="belief2" onclick="toggleNode(this)">
                        <rect x="610" y="300" width="140" height="60" rx="5" fill="#3B82F6" stroke="#1E40AF" stroke-width="2"/>
                        <text x="680" y="320" text-anchor="middle" font-size="10" fill="white" font-weight="bold">Mandates increase</text>
                        <text x="680" y="335" text-anchor="middle" font-size="10" fill="white" font-weight="bold">housing costs</text>
                        <text x="680" y="350" text-anchor="middle" font-size="10" fill="white" font-weight="bold">$50K+ per unit</text>
                    </g>

                    <g class="node" data-id="belief3" onclick="toggleNode(this)">
                        <rect x="300" y="220" width="140" height="60" rx="5" fill="#3B82F6" stroke="#1E40AF" stroke-width="2"/>
                        <text x="370" y="240" text-anchor="middle" font-size="10" fill="white" font-weight="bold">Parking shortages</text>
                        <text x="370" y="255" text-anchor="middle" font-size="10" fill="white" font-weight="bold">hurt local</text>
                        <text x="370" y="270" text-anchor="middle" font-size="10" fill="white" font-weight="bold">businesses</text>
                    </g>

                    <g class="node" data-id="belief4" onclick="toggleNode(this)">
                        <rect x="630" y="420" width="140" height="60" rx="5" fill="#3B82F6" stroke="#1E40AF" stroke-width="2"/>
                        <text x="700" y="440" text-anchor="middle" font-size="10" fill="white" font-weight="bold">40% of parking</text>
                        <text x="700" y="455" text-anchor="middle" font-size="10" fill="white" font-weight="bold">spaces sit</text>
                        <text x="700" y="470" text-anchor="middle" font-size="10" fill="white" font-weight="bold">empty daily</text>
                    </g>

                    <g class="node" data-id="value1" onclick="toggleNode(this)">
                        <ellipse cx="330" cy="390" rx="70" ry="45" fill="#A855F7" stroke="#7C3AED" stroke-width="2"/>
                        <text x="330" y="385" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Personal</text>
                        <text x="330" y="400" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Freedom</text>
                    </g>

                    <g class="node" data-id="value2" onclick="toggleNode(this)">
                        <ellipse cx="650" cy="500" rx="70" ry="45" fill="#A855F7" stroke="#7C3AED" stroke-width="2"/>
                        <text x="650" y="495" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Housing</text>
                        <text x="650" y="510" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Affordability</text>
                    </g>

                    <g class="node" data-id="value3" onclick="toggleNode(this)">
                        <ellipse cx="520" cy="210" rx="70" ry="45" fill="#A855F7" stroke="#7C3AED" stroke-width="2"/>
                        <text x="520" y="205" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Economic</text>
                        <text x="520" y="220" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Vitality</text>
                    </g>

                    <g class="node" data-id="value4" onclick="toggleNode(this)">
                        <ellipse cx="700" cy="450" rx="70" ry="45" fill="#A855F7" stroke="#7C3AED" stroke-width="2"/>
                        <text x="700" y="445" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Environmental</text>
                        <text x="700" y="460" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Responsibility</text>
                    </g>

                    <g class="node" data-id="value5" onclick="toggleNode(this)">
                        <ellipse cx="430" cy="500" rx="70" ry="45" fill="#A855F7" stroke="#7C3AED" stroke-width="2"/>
                        <text x="430" y="495" text-anchor="middle" font-size="11" fill="white" font-weight="bold">Convenience</text>
                        <text x="430" y="510" text-anchor="middle" font-size="10" fill="white">(easy access)</text>
                    </g>

                    <g class="node" data-id="oppose" onclick="toggleNode(this)">
                        <rect x="730" y="640" width="140" height="60" rx="5" fill="#EF4444" stroke="#B91C1C" stroke-width="3"/>
                        <text x="800" y="665" text-anchor="middle" font-size="12" fill="white" font-weight="bold">OPPOSE</text>
                        <text x="800" y="685" text-anchor="middle" font-size="11" fill="white">Eliminating</text>
                    </g>

                    <g class="node" data-id="support" onclick="toggleNode(this)">
                        <rect x="130" y="640" width="140" height="60" rx="5" fill="#10B981" stroke="#047857" stroke-width="3"/>
                        <text x="200" y="665" text-anchor="middle" font-size="12" fill="white" font-weight="bold">SUPPORT</text>
                        <text x="200" y="685" text-anchor="middle" font-size="11" fill="white">Eliminating</text>
                    </g>

                    <g class="node" data-id="uncertain" onclick="toggleNode(this)">
                        <rect x="430" y="630" width="140" height="60" rx="5" fill="#F59E0B" stroke="#D97706" stroke-width="3"/>
                        <text x="500" y="655" text-anchor="middle" font-size="12" fill="white" font-weight="bold">UNCERTAIN</text>
                        <text x="500" y="675" text-anchor="middle" font-size="11" fill="white">Context-Dependent</text>
                    </g>
                </svg>
            </div>
        </div>

        <div id="info-panel" class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded hidden">
            <h3 class="font-bold text-lg mb-2">Node Information</h3>
            <p id="info-text" class="text-gray-700"></p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mt-6">
            <div class="bg-red-50 border border-red-200 p-6 rounded-lg">
                <h3 class="font-bold text-lg text-red-800 mb-3">🚗 Pro-Mandate Pathway</h3>
                <p class="text-sm text-gray-700">
                    <strong>Local News</strong> → Reports parking shortages → Activates <strong>convenience</strong> and <strong>personal freedom</strong> values → Leads to <strong>opposing</strong> mandate elimination
                </p>
            </div>

            <div class="bg-green-50 border border-green-200 p-6 rounded-lg">
                <h3 class="font-bold text-lg text-green-800 mb-3">🏠 Anti-Mandate Pathway</h3>
                <p class="text-sm text-gray-700">
                    <strong>Strong Towns research</strong> → Shows $50K cost increase → Activates <strong>affordability</strong> and <strong>environmental</strong> values → Leads to <strong>supporting</strong> mandate elimination
                </p>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 p-6 rounded-lg">
                <h3 class="font-bold text-lg text-yellow-800 mb-3">🏪 Business Owner Pathway</h3>
                <p class="text-sm text-gray-700">
                    <strong>Personal experience</strong> → Believes parking shortages hurt business → Activates <strong>economic vitality</strong> value → Leads to <strong>opposing</strong> mandate elimination (despite caring about affordability)
                </p>
            </div>
            
            <div class="bg-yellow-100 border border-yellow-300 p-6 rounded-lg">
                <h3 class="font-bold text-lg text-yellow-900 mb-3">🏗️ Uncertain/Developer Path</h3>
                <p class="text-sm text-gray-700">
                    <strong>Developer Talking Points</strong> → Focus on cost savings/inefficiency → Activates **Economic Vitality** → Outcome depends on current market and project type → **UNCERTAIN**
                </p>
            </div>
        </div>
    </div>

    <script>
        let activeNodes = new Set();

        function toggleNode(element) {
            const nodeId = element.getAttribute('data-id');
            
            if (activeNodes.has(nodeId)) {
                element.classList.remove('active');
                activeNodes.delete(nodeId);
            } else {
                element.classList.add('active');
                activeNodes.add(nodeId);
            }

            showNodeInfo(nodeId);
        }

        function showNodeInfo(nodeId) {
            const infoPanel = document.getElementById('info-panel');
            const infoText = document.getElementById('info-text');
            
            const nodeInfo = {
                'center': 'Central Issue: The focal question around which all beliefs, values, and sources connect.',
                'source1': 'Local News: Often emphasizes conflict and problems (negativity bias). Shapes what issues seem urgent.',
                'source2': 'Strong Towns: Urbanist think tank providing research on parking costs and land use.',
                'source3': 'Personal Experience: Individual observations while driving. Powerful but potentially unrepresentative.',
                'source4': 'Neighbor Conversations: Social networks (Nextdoor, Facebook) amplify local concerns.',
                'source5': 'City Planner Reports: Official data and traffic studies. May not reach broad public.',
                'source6': 'Developer Talking Points: Business interests in reduced regulation and construction costs.',
                'belief1': 'Belief: "Without mandates there won\'t be enough parking" - Assumes worst-case scenario.',
                'belief2': 'Belief: "Mandates increase housing costs by $50K+" - Research-backed claim about development costs.',
                'belief3': 'Belief: "Parking shortages hurt businesses" - Concern about customer access and revenue.',
                'belief4': 'Belief: "40% of parking sits empty" - Data showing oversupply and inefficiency.',
                'value1': 'Value: Personal Freedom - The right to drive and park easily is seen as fundamental.',
                'value2': 'Value: Housing Affordability - Access to affordable housing is a priority.',
                'value3': 'Value: Economic Vitality - Supporting local businesses and economic health.',
                'value4': 'Value: Environmental Responsibility - Climate action and sustainability matter.',
                'value5': 'Value: Convenience - Easy access and avoiding hassle.',
                'oppose': 'Opinion: OPPOSE eliminating mandates. Prioritizes convenience, freedom, and business concerns.',
                'support': 'Opinion: SUPPORT eliminating mandates. Prioritizes affordability, environment, and efficiency.',
                'uncertain': 'Opinion: UNCERTAIN. Sees validity in multiple perspectives. "It depends on context." Developers and politicians often land here as they balance conflicting demands.',
            };

            if (nodeInfo[nodeId]) {
                infoText.textContent = nodeInfo[nodeId];
                infoPanel.classList.remove('hidden');
            }
        }

        function showPathway(type) {
            clearPathways();
            
            const lines = document.querySelectorAll('.pathway-' + type);
            lines.forEach(line => {
                line.classList.add('active', 'pathway-active');
                
                // Use a different color for the Uncertain path for better distinction
                const strokeColor = (type === 'uncertain') ? '#F59E0B' : '#3B82F6'; 

                line.setAttribute('stroke', strokeColor);
                line.setAttribute('stroke-width', '4');
                line.setAttribute('marker-end', 'url(#arrowhead-active)');
            });
        }

        function clearPathways() {
            const lines = document.querySelectorAll('.connection-line');
            lines.forEach(line => {
                line.classList.remove('active', 'pathway-active');
                line.setAttribute('stroke', '#666');
                line.setAttribute('stroke-width', '2');
                line.setAttribute('marker-end', 'url(#arrowhead)');
            });

            const nodes = document.querySelectorAll('.node');
            nodes.forEach(node => node.classList.remove('active'));
            activeNodes.clear();
            
            document.getElementById('info-panel').classList.add('hidden');
        }
    </script>
</body>
</html>